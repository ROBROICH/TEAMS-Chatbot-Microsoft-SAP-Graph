function e(e,t,n,r){return new(n||(n=Promise))(function(s,i){function o(e){try{d(r.next(e))}catch(e){i(e)}}function a(e){try{d(r.throw(e))}catch(e){i(e)}}function d(e){e.done?s(e.value):new n(function(t){t(e.value)}).then(o,a)}d((r=r.apply(e,t||[])).next())})}var t;!function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(t||(t={}));class n{constructor(e){if(this.requests=new Map,void 0!==e){const t=n.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let n=t.next();for(;!n.done;){const e=n.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const r=n.value[1];if(void 0!==r.dependsOn&&r.dependsOn.length>0)return!1;let s=n;for(n=t.next();!n.done;){const e=n.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==s.value[1].id)return!1;s=n,n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const r=n.value[1];let s;if(void 0===r.dependsOn||0===r.dependsOn.length)s=r.id;else{if(1!==r.dependsOn.length)return!1;{const t=r.dependsOn[0];if(t===r.id||!e.has(t))return!1;s=t}}for(n=t.next();!n.done;){const e=n.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&s!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===s||e.dependsOn[0]!==s))return!1;if(e.dependsOn.length>1)return!1}n=t.next()}return!0})(e)}static getRequestData(r){return e(this,void 0,void 0,function*(){const e={url:""},s=new RegExp("^https?://");e.url=s.test(r.url)?"/"+r.url.split(/.*?\/\/.*?\//)[1]:r.url,e.method=r.method;const i={};return r.headers.forEach((e,t)=>{i[t]=e}),Object.keys(i).length&&(e.headers=i),r.method!==t.PATCH&&r.method!==t.POST&&r.method!==t.PUT||(e.body=yield n.getRequestBody(r)),e})}static getRequestBody(t){return e(this,void 0,void 0,function*(){let e,n=!1;try{const r=t.clone();e=yield r.json(),n=!0}catch(e){}if(!n)try{if("undefined"!=typeof Blob){const n=yield t.blob(),r=new FileReader;e=yield new Promise(e=>{r.addEventListener("load",()=>{const t=r.result,n=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(n[4])},!1),r.readAsDataURL(n)})}else if("undefined"!=typeof Buffer){e=(yield t.buffer()).toString("base64")}n=!0}catch(e){}return e})}addRequest(e){const t=n.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),n=this.requests.entries();let r=n.next();for(;!r.done;){const t=r.value[1].dependsOn;if(void 0!==t){const n=t.indexOf(e);-1!==n&&t.splice(n,1),0===t.length&&delete r.value[1].dependsOn}r=n.next()}return t}getContent(){return e(this,void 0,void 0,function*(){const e=[],t={requests:e},r=this.requests.entries();let s=r.next();if(s.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!n.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!s.done;){const t=s.value[1],i=yield n.getRequestData(t.request);if(void 0!==i.body&&(void 0===i.headers||void 0===i.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}i.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(i.dependsOn=t.dependsOn),e.push(i),s=r.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const n=this.requests.get(e);if(void 0===n.dependsOn&&(n.dependsOn=[]),-1!==n.dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}n.dependsOn.push(t)}else{const n=this.requests.entries();let r,s=n.next();for(;!s.done&&s.value[1].id!==e;)r=s,s=n.next();if(void 0===r){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=r.value[0];if(void 0===s.value[1].dependsOn&&(s.value[1].dependsOn=[]),-1!==s.value[1].dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}s.value[1].dependsOn.push(t)}}}removeDependency(e,t){const n=this.requests.get(e);if(void 0===n||void 0===n.dependsOn||0===n.dependsOn.length)return!1;if(void 0!==t){const e=n.dependsOn.indexOf(t);return-1!==e&&(n.dependsOn.splice(e,1),!0)}return delete n.dependsOn,!0}}n.requestLimit=20;class r{constructor(e){this.responses=new Map,this.update(e)}createResponseObject(e){const t=e.body,n={};if(n.status=e.status,void 0!==e.statusText&&(n.statusText=e.statusText),n.headers=e.headers,void 0!==n.headers&&void 0!==n.headers["Content-Type"]&&"application/json"===n.headers["Content-Type"].split(";")[0]){const e=JSON.stringify(t);return new Response(e,n)}return new Response(t,n)}update(e){this.nextLink=e["@odata.nextLink"];const t=e.responses;for(let e=0,n=t.length;e<n;e++)this.responses.set(t[e].id,this.createResponseObject(t[e]))}getResponseById(e){return this.responses.get(e)}getResponses(){return this.responses}*getResponsesIterator(){const e=this.responses.entries();let t=e.next();for(;!t.done;)yield t.value,t=e.next()}}class s{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const i=()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e},o=(e,t,n)=>{let r=null;if("undefined"!=typeof Request&&e instanceof Request)r=e.headers.get(n);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)r=t.headers.get(n);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,s=e.length;t<s;t++)if(e[t][0]===n){r=e[t][1];break}}else void 0!==t.headers[n]&&(r=t.headers[n]);return r},a=(e,t,n,r)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(n,r);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[n]:r});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(n,r);else if(t.headers instanceof Array){let e=0;const s=t.headers.length;for(;e<s;e++){const s=t.headers[e];if(s[0]===n){s[1]=r;break}}e===s&&t.headers.push([n,r])}else Object.assign(t.headers,{[n]:r})},d=(e,t,n,r)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(n,r):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[n]:r}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(n,r):t.headers instanceof Array?t.headers.push([n,r]):void 0===t.headers?t.headers={[n]:r}:void 0===t.headers[n]?t.headers[n]=r:t.headers[n]+=`, ${r}`)},c=(t,n)=>e(void 0,void 0,void 0,function*(){const e=n.headers.get("Content-Type")?yield n.blob():yield Promise.resolve(void 0),{method:r,headers:s,referrer:i,referrerPolicy:o,mode:a,credentials:d,cache:c,redirect:h,integrity:l,keepalive:u,signal:p}=n;return new Request(t,{method:r,headers:s,body:e,referrer:i,referrerPolicy:o,mode:a,credentials:d,cache:c,redirect:h,integrity:l,keepalive:u,signal:p})});class h{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var l;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(l||(l={}));class u{constructor(){this.featureUsage=l.NONE}static updateFeatureUsageFlag(e,t){let n;e.middlewareControl instanceof s?n=e.middlewareControl.getMiddlewareOptions(u):e.middlewareControl=new s,void 0===n&&(n=new u,e.middlewareControl.setMiddlewareOptions(u,n)),n.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class p{constructor(e){this.authenticationProvider=e}execute(t){return e(this,void 0,void 0,function*(){try{let e,n,r;t.middlewareControl instanceof s&&(e=t.middlewareControl.getMiddlewareOptions(h)),void 0!==e&&(n=e.authenticationProvider,r=e.authenticationProviderOptions),void 0===n&&(n=this.authenticationProvider);const i=`Bearer ${yield n.getAccessToken(r)}`;return d(t.request,t.options,p.AUTHORIZATION_HEADER,i),u.updateFeatureUsageFlag(t,l.AUTHENTICATION_HANDLER_ENABLED),yield this.nextMiddleware.execute(t)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}p.AUTHORIZATION_HEADER="Authorization";class f{execute(t){return e(this,void 0,void 0,function*(){try{return void(t.response=yield fetch(t.request,t.options))}catch(e){throw e}})}}class y{constructor(e=y.DEFAULT_DELAY,t=y.DEFAULT_MAX_RETRIES,n=y.DEFAULT_SHOULD_RETRY){if(e>y.MAX_DELAY&&t>y.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${y.MAX_DELAY} and ${y.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>y.MAX_DELAY){const e=new Error(`Delay should not be more than ${y.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>y.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${y.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,y.MAX_DELAY),this.maxRetries=Math.min(t,y.MAX_MAX_RETRIES),this.shouldRetry=n}getMaxDelay(){return y.MAX_DELAY}}y.DEFAULT_DELAY=3,y.DEFAULT_MAX_RETRIES=3,y.MAX_DELAY=180,y.MAX_MAX_RETRIES=10,y.DEFAULT_SHOULD_RETRY=()=>!0;class m{constructor(e=new y){this.options=e}isRetry(e){return-1!==m.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,n){const r="string"==typeof e?n.method:e.method;if(r===t.PUT||r===t.PATCH||r===t.POST){if("application/octet-stream"===o(e,n,"Content-Type"))return!1}return!0}getDelay(e,t,n){const r=()=>Number(Math.random().toFixed(3)),s=void 0!==e.headers?e.headers.get(m.RETRY_AFTER_HEADER):null;let i;return i=null!==s?Number.isNaN(Number(s))?Math.round((new Date(s).getTime()-Date.now())/1e3):Number(s):t>=2?this.getExponentialBackOffTime(t)+n+r():n+r(),Math.min(i,this.options.getMaxDelay()+r())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(t){return e(this,void 0,void 0,function*(){const e=1e3*t;return new Promise(t=>setTimeout(t,e))})}getOptions(e){let t;return e.middlewareControl instanceof s&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new y,this.options)),t}executeWithRetry(t,n,r){return e(this,void 0,void 0,function*(){try{if(yield this.nextMiddleware.execute(t),n<r.maxRetries&&this.isRetry(t.response)&&this.isBuffered(t.request,t.options)&&r.shouldRetry(r.delay,n,t.request,t.options,t.response)){++n,a(t.request,t.options,m.RETRY_ATTEMPT_HEADER,n.toString());const e=this.getDelay(t.response,n,r.delay);return yield this.sleep(e),yield this.executeWithRetry(t,n,r)}return}catch(e){throw e}})}execute(t){return e(this,void 0,void 0,function*(){try{const e=0,n=this.getOptions(t);return u.updateFeatureUsageFlag(t,l.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(t,e,n)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}m.RETRY_STATUS_CODES=[429,503,504],m.RETRY_ATTEMPT_HEADER="Retry-Attempt",m.RETRY_AFTER_HEADER="Retry-After";const E="2.0.0";class v{execute(t){return e(this,void 0,void 0,function*(){try{let e=o(t.request,t.options,v.CLIENT_REQUEST_ID_HEADER);null===e&&(e=i(),a(t.request,t.options,v.CLIENT_REQUEST_ID_HEADER,e));let n,r=`${v.PRODUCT_NAME}/${E}`;if(t.middlewareControl instanceof s&&(n=t.middlewareControl.getMiddlewareOptions(u)),void 0!==n){const e=n.getFeatureUsage();r+=` (${v.FEATURE_USAGE_STRING}=${e})`}return d(t.request,t.options,v.SDK_VERSION_HEADER,r),yield this.nextMiddleware.execute(t)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}v.CLIENT_REQUEST_ID_HEADER="client-request-id",v.SDK_VERSION_HEADER="SdkVersion",v.PRODUCT_NAME="graph-js",v.FEATURE_USAGE_STRING="featureUsage";class w{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class R{constructor(e,t,n,r={}){this.DEFAULT_FILE_SIZE=5242880,this.client=e,this.file=t,void 0===r.rangeSize&&(r.rangeSize=this.DEFAULT_FILE_SIZE),this.options=r,this.uploadSession=n,this.nextRange=new w(0,this.options.rangeSize-1)}static createUploadSession(t,n,r,s={}){return e(this,void 0,void 0,function*(){try{const e=yield t.api(n).headers(s).post(r);return{url:e.uploadUrl,expiry:new Date(e.expirationDateTime)}}catch(e){throw e}})}parseRange(e){const t=e[0];if(void 0===t||""===t)return new w;const n=t.split("-"),r=parseInt(n[0],10);let s=parseInt(n[1],10);return Number.isNaN(s)&&(s=this.file.size-1),new w(r,s)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new w(e,t)}sliceFile(e){return this.file.content.slice(e.minValue,e.maxValue+1)}upload(){return e(this,void 0,void 0,function*(){try{for(;;){const e=this.getNextRange();if(-1===e.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const t=this.sliceFile(e),n=yield this.uploadSlice(t,e,this.file.size);if(void 0!==n.id)return n;this.updateTaskStatus(n)}}catch(e){throw e}})}uploadSlice(t,n,r){return e(this,void 0,void 0,function*(){try{return yield this.client.api(this.uploadSession.url).headers({"Content-Length":`${n.maxValue-n.minValue+1}`,"Content-Range":`bytes ${n.minValue}-${n.maxValue}/${r}`}).put(t)}catch(e){throw e}})}cancel(){return e(this,void 0,void 0,function*(){try{return yield this.client.api(this.uploadSession.url).delete()}catch(e){throw e}})}getStatus(){return e(this,void 0,void 0,function*(){try{const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e}catch(e){throw e}})}resume(){return e(this,void 0,void 0,function*(){try{return yield this.getStatus(),yield this.upload()}catch(e){throw e}})}}const g=(e=5242880)=>{return e>62914560&&(e=62914560),(e=>(e>327680&&(e=320*Math.floor(e/327680)*1024),e))(e)};class A extends R{constructor(e,t,n,r){super(e,t,n,r)}static constructCreateSessionUrl(e,t=A.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),encodeURI(`/me/drive/root:${t}${e}:/createUploadSession`)}static create(t,n,r){return e(this,void 0,void 0,function*(){const e=r.fileName;let s,i;if("undefined"!=typeof Blob&&n instanceof Blob)i=(s=new File([n],e)).size;else if("undefined"!=typeof File&&n instanceof File)i=(s=n).size;else if("undefined"!=typeof Buffer&&n instanceof Buffer){const e=n;i=e.byteLength-e.byteOffset,s=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}try{const n=A.constructCreateSessionUrl(r.fileName,r.path),o=yield A.createUploadSession(t,n,r.fileName),a=g(r.rangeSize);return new A(t,{name:e,content:s,size:i},o,{rangeSize:a})}catch(e){throw e}})}static createUploadSession(t,n,r){const s=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return e(this,void 0,void 0,function*(){const e={item:{"@microsoft.graph.conflictBehavior":"rename",name:r}};try{return s.createUploadSession.call(this,t,n,e)}catch(e){throw e}})}commit(t){return e(this,void 0,void 0,function*(){try{const e={name:this.file.name,"@microsoft.graph.conflictBehavior":"rename","@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(t).put(e)}catch(e){throw e}})}}A.DEFAULT_UPLOAD_PATH="/";class T{constructor(e,t,n){this.client=e,this.collection=t.value,this.nextLink=t["@odata.nextLink"],this.deltaLink=t["@odata.deltaLink"],this.callback=n,this.complete=!1}iterationHelper(){if(void 0===this.collection)return!1;let e=!0;for(;e&&0!==this.collection.length;){const t=this.collection.shift();e=this.callback(t)}return e}fetchAndUpdateNextPageData(){return e(this,void 0,void 0,function*(){try{const e=yield this.client.api(this.nextLink).get();this.collection=e.value,this.nextLink=e["@odata.nextLink"],this.deltaLink=e["@odata.deltaLink"]}catch(e){throw e}})}getDeltaLink(){return this.deltaLink}iterate(){return e(this,void 0,void 0,function*(){try{let e=this.iterationHelper();for(;e;)void 0!==this.nextLink?(yield this.fetchAndUpdateNextPageData(),e=this.iterationHelper()):e=!1;void 0===this.nextLink&&0===this.collection.length&&(this.complete=!0)}catch(e){throw e}})}resume(){return e(this,void 0,void 0,function*(){try{return this.iterate()}catch(e){throw e}})}isComplete(){return this.complete}}const O="v1.0",D="https://graph.microsoft.com/";class x{constructor(e){this.provider=e}getAccessToken(){return e(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((n,r)=>{r?e(r):t(n)})})})}}class _{constructor(e=-1){this.statusCode=e,this.code=null,this.message=null,this.requestId=null,this.date=new Date,this.body=null}}class b{static constructError(e,t){const n=new _(t);return void 0!==e.name&&(n.code=e.name),n.body=e.toString(),n.message=e.message,n.date=new Date,n}static constructErrorFromResponse(e,t){e=e.error;const n=new _(t);n.code=e.code,n.message=e.message,void 0!==e.innerError&&(n.requestId=e.innerError["request-id"],n.date=new Date(e.innerError.date));try{n.body=JSON.stringify(e)}catch(e){}return n}static getError(t=null,n=-1,r){return e(this,void 0,void 0,function*(){let e;if(e=t&&t.error?b.constructErrorFromResponse(t,n):"undefined"!=typeof Error&&t instanceof Error?b.constructError(t,n):new _(n),"function"!=typeof r)return e;r(e,null)})}}const L=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],P=e=>{const t=e=>e.replace(/\/+$/,""),n=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce((e,r)=>[t(e),n(r)].join("/"))},S=e=>{const t=e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e};var U,C,M,N;!function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(U||(U={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(C||(C={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(M||(M={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(N||(N={}));class q{static parseDocumentResponse(e,t){try{return"undefined"!=typeof DOMParser?new Promise((n,r)=>{e.text().then(e=>{try{const s=(new DOMParser).parseFromString(e,t);n(s)}catch(e){r(e)}})}):Promise.resolve(e.body)}catch(e){throw e}}static convertResponse(t,n){return e(this,void 0,void 0,function*(){if(204===t.status)return Promise.resolve();let e;try{switch(n){case U.ARRAYBUFFER:e=yield t.arrayBuffer();break;case U.BLOB:e=yield t.blob();break;case U.DOCUMENT:e=yield q.parseDocumentResponse(t,C.TEXT_XML);break;case U.JSON:e=yield t.json();break;case U.STREAM:e=yield Promise.resolve(t.body);break;case U.TEXT:e=yield t.text();break;default:const r=t.headers.get("Content-type");if(null!==r){const n=r.split(";")[0];e=new RegExp(N.DOCUMENT).test(n)?yield q.parseDocumentResponse(t,n):new RegExp(N.IMAGE).test(n)?t.blob():n===M.TEXT_PLAIN?yield t.text():n===M.APPLICATION_JSON?yield t.json():Promise.resolve(t.body)}else e=Promise.resolve(t.body)}}catch(e){throw e}return e})}static getResponse(t,n,r){return e(this,void 0,void 0,function*(){try{if(n===U.RAW)return Promise.resolve(t);{const e=yield q.convertResponse(t,n);if(!t.ok)throw e;if("function"!=typeof r)return e;r(null,e)}}catch(e){throw e}})}}class I{constructor(e,t,n){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const n=e.indexOf("/");-1!==n&&(this.urlComponents.version=e.substring(0,n),e=e.substring(n+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const n=e.substring(t+1,e.length).split("&");for(const e of n){const t=e.split("="),n=t[0],r=t[1];-1!==L.indexOf(n)?this.urlComponents.oDataQueryParams[n]=r:this.urlComponents.otherURLQueryParams[n]=r}}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{}},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}addCsvQueryParameter(e,t,n){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let r=[];n.length>1&&"string"==typeof t?r=Array.prototype.slice.call(n):"string"==typeof t?r.push(t):r=r.concat(t),this.urlComponents.oDataQueryParams[e]+=r.join(",")}buildFullUrl(){const e=P([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const n in e.oDataQueryParams)e.oDataQueryParams.hasOwnProperty(n)&&t.push(n+"="+e.oDataQueryParams[n]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const n in e.otherURLQueryParams)e.otherURLQueryParams.hasOwnProperty(n)&&t.push(n+"="+e.otherURLQueryParams[n]);return t.length>0?"?"+t.join("&"):""}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(t,n,r){return e(this,void 0,void 0,function*(){let e;const i=new s(this._middlewareOptions);this.updateRequestOptions(n);try{return e=(yield this.httpClient.sendRequest({request:t,options:n,middlewareControl:i})).response,yield q.getResponse(e,this._responseType,r)}catch(t){let n;throw void 0!==e&&(n=e.status),yield b.getError(t,n,r)}})}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)e.hasOwnProperty(t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)e.hasOwnProperty(t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){const t=this.urlComponents.otherURLQueryParams;if("string"==typeof e){const n=e.split("="),r=n[0],s=n[1];t[r]=s}else for(const n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return this}get(n){return e(this,void 0,void 0,function*(){const e=this.buildFullUrl(),r={method:t.GET};try{return yield this.send(e,r,n)}catch(e){throw e}})}post(n,r){return e(this,void 0,void 0,function*(){const e=this.buildFullUrl(),s={method:t.POST,body:S(n),headers:"undefined"!=typeof FormData&&n instanceof FormData?{}:{"Content-Type":"application/json"}};try{return yield this.send(e,s,r)}catch(e){throw e}})}create(t,n){return e(this,void 0,void 0,function*(){try{return yield this.post(t,n)}catch(e){throw e}})}put(n,r){return e(this,void 0,void 0,function*(){const e=this.buildFullUrl(),s={method:t.PUT,body:S(n),headers:{"Content-Type":"application/json"}};try{return yield this.send(e,s,r)}catch(e){throw e}})}patch(n,r){return e(this,void 0,void 0,function*(){const e=this.buildFullUrl(),s={method:t.PATCH,body:S(n),headers:{"Content-Type":"application/json"}};try{return yield this.send(e,s,r)}catch(e){throw e}})}update(t,n){return e(this,void 0,void 0,function*(){try{return yield this.patch(t,n)}catch(e){throw e}})}delete(n){return e(this,void 0,void 0,function*(){const e=this.buildFullUrl(),r={method:t.DELETE};try{return yield this.send(e,r,n)}catch(e){throw e}})}del(t){return e(this,void 0,void 0,function*(){try{return yield this.delete(t)}catch(e){throw e}})}getStream(n){return e(this,void 0,void 0,function*(){const e=this.buildFullUrl(),r={method:t.GET};this.responseType(U.STREAM);try{return yield this.send(e,r,n)}catch(e){throw e}})}putStream(n,r){return e(this,void 0,void 0,function*(){const e=this.buildFullUrl(),s={method:t.PUT,headers:{"Content-Type":"application/octet-stream"},body:n};try{return yield this.send(e,s,r)}catch(e){throw e}})}}class F{constructor(e){this.middleware=e}sendRequest(t){return e(this,void 0,void 0,function*(){try{if("string"==typeof t.request&&void 0===t.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(t),t}catch(e){throw e}})}}class H{constructor(e=H.DEFAULT_MAX_REDIRECTS,t=H.DEFAULT_SHOULD_RETRY){if(e>H.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${H.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}H.DEFAULT_MAX_REDIRECTS=5,H.MAX_MAX_REDIRECTS=20,H.DEFAULT_SHOULD_RETRY=()=>!0;class k{constructor(e=new H){this.options=e}isRedirect(e){return-1!==k.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(k.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(k.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const n=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,r=n.exec(e);let s,i;null!==r&&(s=r[0]);const o=n.exec(t);return null!==o&&(i=o[0]),void 0!==s&&void 0!==i&&s!==i}updateRequestUrl(t,n){return e(this,void 0,void 0,function*(){n.request="string"==typeof n.request?t:yield c(t,n.request)})}getOptions(e){let t;return e.middlewareControl instanceof s&&(t=e.middlewareControl.getMiddlewareOptions(H)),void 0===t&&(t=Object.assign(new H,this.options)),t}executeWithRedirect(n,r,s){return e(this,void 0,void 0,function*(){try{yield this.nextMiddleware.execute(n);const e=n.response;if(!(r<s.maxRedirects&&this.isRedirect(e)&&this.hasLocationHeader(e)&&s.shouldRedirect(e)))return;if(++r,e.status===k.STATUS_CODE_SEE_OTHER)n.options.method=t.GET,delete n.options.body;else{const t=this.getLocationHeader(e);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(e.url,t)&&a(n.request,n.options,k.AUTHORIZATION_HEADER,void 0),yield this.updateRequestUrl(t,n)}yield this.executeWithRedirect(n,r,s)}catch(e){throw e}})}execute(t){return e(this,void 0,void 0,function*(){try{const e=0,n=this.getOptions(t);return t.options.redirect=k.MANUAL_REDIRECT,u.updateFeatureUsageFlag(t,l.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(t,e,n)}catch(e){throw e}})}setNext(e){this.nextMiddleware=e}}k.REDIRECT_STATUS_CODES=[301,302,303,307,308],k.STATUS_CODE_SEE_OTHER=303,k.LOCATION_HEADER="Location",k.AUTHORIZATION_HEADER="Authorization",k.MANUAL_REDIRECT="manual";const $=()=>new Function("try {return this === global;}catch(e){return false;}")();class X{static createWithAuthenticationProvider(e){const t=new p(e),n=new m(new y),r=new v,s=new f;if(t.setNext(n),$()){const e=new k(new H);n.setNext(e),e.setNext(r)}else n.setNext(r);return r.setNext(s),X.createWithMiddleware(t)}static createWithMiddleware(e){return new F(e)}}const B=()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}return!0};class Q{constructor(e){this.config={baseUrl:D,debugLogging:!1,defaultVersion:O};try{B()}catch(e){throw e}for(const t in e)e.hasOwnProperty(t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=X.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new F(e.middleware)}this.httpClient=t}static init(e){const t={};for(const n in e)e.hasOwnProperty(n)&&(t[n]="authProvider"===n?new x(e[n]):e[n]);return Q.initWithMiddleware(t)}static initWithMiddleware(e){try{return new Q(e)}catch(e){throw e}}api(e){return new I(this.httpClient,this.config,e)}}class j{constructor(e,t){this.options=t,this.msalApplication=e}getAccessToken(t){return e(this,void 0,void 0,function*(){let e;if(void 0!==t&&(e=t.scopes),void 0!==e&&0!==e.length||(e=this.options.scopes),0===e.length){const e=new Error;throw e.name="EmptyScopes",e.message="Scopes cannot be empty, Please provide a scopes",e}if(this.msalApplication.getAccount()){const t={scopes:e};try{return(yield this.msalApplication.acquireTokenSilent(t)).accessToken}catch(e){if("InteractionRequiredAuthError"!==e.name)throw e;try{return(yield this.msalApplication.acquireTokenPopup(t)).accessToken}catch(e){throw e}}}else try{const t={scopes:e};return yield this.msalApplication.loginPopup(t),(yield this.msalApplication.acquireTokenSilent(t)).accessToken}catch(e){throw e}})}}class Y{constructor(e){this.scopes=e}}export{p as AuthenticationHandler,h as AuthenticationHandlerOptions,n as BatchRequestContent,r as BatchResponseContent,Q as Client,l as FeatureUsageFlag,_ as GraphError,I as GraphRequest,f as HTTPMessageHandler,j as ImplicitMSALAuthenticationProvider,R as LargeFileUploadTask,Y as MSALAuthenticationProviderOptions,A as OneDriveLargeFileUploadTask,T as PageIterator,U as ResponseType,m as RetryHandler,y as RetryHandlerOptions,v as TelemetryHandler,u as TelemetryHandlerOptions};
